{"version":3,"sources":["utilities.js","App.js","index.js"],"names":["EYES","drawMesh","predictions","ctx","avr_x","avr_y","status","length","forEach","prediction","keypoints","scaledMesh","x_sum","y_sum","Array","from","i","x","y","beginPath","arc","Math","PI","rightPosition","JSON","parse","localStorage","getItem","fillStyle","Audio","play","fill","position","setItem","App","webcamRef","useRef","canvasRef","useState","setPosition","setStatus","setCtx","advise","setAdvise","message","setMessage","useEffect","current","getContext","runFacemesh","a","facemesh","inputResolution","width","height","scale","net","setInterval","detect","video","readyState","videoWidth","videoHeight","estimateFaces","face","result","className","style","backgroundColor","ref","mirrored","onClick","stringify","disabled","clearRect","removeItem","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a4cdfd0c.chunk.js","sourcesContent":["export const EYES = [\n  7, // LEFT_EYE\n  33,\n  133,\n  144,\n  145,\n  153,\n  154,\n  155,\n  157,\n  158,\n  159,\n  160,\n  161,\n  163,\n  173,\n  246,\n  249, // RIGHT_EYE\n  263,\n  362,\n  373,\n  374,\n  380,\n  381,\n  382,\n  384,\n  385,\n  386,\n  387,\n  388,\n  390,\n  398,\n  466\n];\n\nexport const drawMesh = (predictions, ctx) => {\n  let avr_x;\n  let avr_y;\n  let status;\n\n  if (predictions.length > 0) {\n    predictions.forEach((prediction) => {\n      const keypoints = prediction.scaledMesh;\n\n      let x_sum = 0;\n      let y_sum = 0;\n\n      Array.from(EYES).forEach((i) => {\n        const x = keypoints[i][0];\n        const y = keypoints[i][1];\n\n        x_sum += x;\n        y_sum += y;\n\n      });\n\n      avr_x = 640 - (x_sum / EYES.length);\n      avr_y = y_sum / EYES.length;\n\n      ctx.beginPath();\n      ctx.arc(avr_x, avr_y, 3, 0, 3 * Math.PI);\n\n      function beep() {\n        var snd = new Audio(\"data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=\");\n\n        snd.play();\n\n      }\n\n      let rightPosition = JSON.parse(localStorage.getItem(\"rightPosition\"));\n      let y = rightPosition ? rightPosition.y : 480;\n\n      if (avr_x < 340 && avr_x > 300 && avr_y < y) {\n        ctx.fillStyle = '#99ff00';\n        status = \"right\";\n      } else if ((avr_x > 340 || avr_x < 300) && avr_y < y) {\n        ctx.fillStyle = '#ffd637';\n        status = \"neutral\";\n      } else if (avr_y > y) {\n        ctx.fillStyle = rightPosition ? '#ff0000' : \"#ffd637\";\n        status = rightPosition ? \"wrong\" : \"neutral\";\n        beep();\n      }\n      ctx.fill();\n    });\n\n    return {\n      position: {\n        x: avr_x,\n        y: avr_y\n      },\n      status: status\n    };\n  }\n};","import React, { useRef, useState, useEffect } from 'react';\nimport './App.css';\nimport * as tf from \"@tensorflow/tfjs\"; // eslint-disable-line no-unused-vars\nimport * as facemesh from \"@tensorflow-models/facemesh\";\nimport Webcam from \"react-webcam\";\nimport { drawMesh } from './utilities';\n\nlocalStorage.setItem(\"watching\", false);\n\nfunction App() {\n\n  const webcamRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  let [position, setPosition] = useState();\n  let [status, setStatus] = useState(\"right\");\n  let [ctx, setCtx] = useState();\n  let [advise, setAdvise] = useState(false);\n  let [message, setMessage] = useState(\"\");\n\n  useEffect(() => {\n    setCtx(canvasRef.current.getContext('2d'));\n  }, []);\n\n  useEffect(() => {\n    if (advise && status === \"neutral\")\n      return setMessage(\"화면 중앙에 기준점을 맞춰주세요.\");\n\n    if (advise)\n      return setMessage(\"교정하고 싶은 자세를 취하고 좌표를 저장해주세요.\");\n\n    if (!advise)\n      return setMessage(\"감시 시작 버튼을 눌러주세요.\");\n\n  }, [advise, status]);\n\n  useEffect(() => {\n    if (ctx) {\n      runFacemesh();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ctx]);\n\n  const runFacemesh = async () => {\n\n    const net = await facemesh.load({\n      inputResolution: { width: 640, height: 480 }, scale: 0.8\n    });\n\n    setInterval(() => {\n      detect(net);\n    }, 100);\n  };\n\n  const detect = async (net) => {\n    let watching = localStorage.getItem(\"watching\");\n\n    if (watching === \"true\" && typeof webcamRef.current !== \"undefined\" && webcamRef.current !== null && webcamRef.current.video.readyState === 4) {\n\n      const video = webcamRef.current.video;\n      const videoWidth = webcamRef.current.video.videoWidth;\n      const videoHeight = webcamRef.current.video.videoHeight;\n\n      webcamRef.current.video.width = videoWidth;\n      webcamRef.current.video.height = videoHeight;\n\n      canvasRef.current.width = videoWidth;\n      canvasRef.current.height = videoHeight;\n\n      const face = await net.estimateFaces(video);\n\n      if (ctx) {\n        let result = drawMesh(face, ctx);\n\n        setPosition(result ? result.position : null);\n        setStatus(result ? result.status : null);\n      }\n    }\n  };\n\n  const saveRightPosition = () => {\n    if (status === \"right\") {\n      localStorage.setItem(\"rightPosition\", JSON.stringify(position));\n    }\n  };\n\n  const watch = () => {\n    setAdvise(true);\n    localStorage.setItem(\"watching\", \"true\");\n  };\n\n  const unWatch = () => {\n    setAdvise(false);\n    localStorage.setItem(\"watching\", \"false\");\n    ctx.clearRect(0, 0, 30000, 30000);\n    ctx.beginPath();\n  };\n\n  const clear = () => {\n    localStorage.removeItem(\"rightPosition\");\n  };\n\n  return (\n    <div className=\"App\"\n      style={{\n        backgroundColor: \"#ffffd2\"\n      }}>\n      <header\n        className=\"App-header\"\n      >\n        <Webcam\n          ref={webcamRef}\n          mirrored\n        />\n        <canvas className={advise ? 'canvas ' + status : 'canvas unadvise'}\n          ref={canvasRef}\n        />\n        {message ?\n          <div className=\"box-comment\">\n            {message}\n          </div> : null\n        }\n\n      </header>\n\n      <div className={'btns'}>\n        {advise ?\n          <button onClick={saveRightPosition}>좌표 설정</button>\n          : <div disabled>좌표 설정</div>\n        }\n        {\n          advise ? <button className={\"on\"} onClick={unWatch}>감시중</button>\n            : <button onClick={watch}>감시 시작</button>\n        }\n        <button onClick={clear}>좌표 초기화</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}